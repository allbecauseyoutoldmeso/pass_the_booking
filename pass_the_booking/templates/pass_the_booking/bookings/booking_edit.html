{% extends 'pass_the_booking/base.html' %}

{% block content %}

   <p>booking details for {{ property.address }}</p>

   <form method='post'>{% csrf_token %}
     {{ form.guest_name.errors }}
     <label for="{{ form.guest_name.id_for_label }}">guest name:</label>
     {{ form.guest_name }}
     {{ form.guest_email.errors }}
     <label for="{{ form.guest_email.id_for_label }}">guest email:</label>
     {{ form.guest_email }}
     {{ form.check_in.errors }}
     <label for="{{ form.check_in.id_for_label }}">check in date:</label>
     {{ form.check_in }}
     {{ form.check_out.errors }}
     <label for="{{ form.check_out.id_for_label }}">check out date:</label>
     {{ form.check_out }}
     <button type='submit'>save</button>
   </form>
   
   <script>
     $(function() {
       $( "#datepicker_to" ).datepicker({
         changeMonth: true,
         changeYear: true,
         minDate: 0,
         dateFormat: "yy-mm-dd"
       });
     });
   </script>

   <script>
    $(document).ready(function() {
      $(function() {
        $('#datepicker_from').datepicker({
          changeMonth: true,
          changeYear: true,
          minDate: 0,
          dateFormat: "yy-mm-dd",
          beforeShowDay: function(date) {
            var disableddates = []
            {% for x in property.unavailable_dates %}
              console.log({{x}})
              disableddates.push(String({{x}}))
            {% endfor %}
            var string = jQuery.datepicker.formatDate('yymmdd', date);
            return [ disableddates.indexOf(string) == -1 ]
          }
        })
      })
    })

</script>

{% endblock %}
